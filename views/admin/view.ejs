<%- include('../partials/header') %>

<%- include('./navbar') %>

<main>
    <h4>View Products</h4>

    <% if(messages.hasOwnProperty('error')) { %>
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <%= messages['error'][0] %>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    <% } %>

    <% if(messages.hasOwnProperty('success')) { %>
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <%= messages['success'][0] %>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    <% } %>

    <div class="row d-flex justify-content-center">
        <div>
            <table class="table table-striped table-dark">
                <thead>
                    <tr>
                        <th scope="col">Id</th>
                        <th scope="col">Image</th>
                        <th scope="col">Name</th>
                        <th scope="col">Description</th>
                        <th scope="col">Category</th>
                        <th scope="col">SKU</th>
                        <th scope="col">Price</th>
                        <th scope="col">Last Updated</th>
                        <th scope="col">Edit</th>
                        <th scope="col">Delete</th>
                    </tr>
                </thead>
                <tbody>
                    <% if(products.length == 0) { %>
                        <tr>
                            <td colspan="10">Nothing to display</td>
                        </tr>
                    <% } %>

                    <% for(let product of products) { %>
                        <tr>
                            <td><%= product._id %></td>
                            <td>
                                <% if(product.productImage) { %>
                                    <img src="<%= product.productImage %>" height="64" width="64">
                                <% } else { %>
                                    <img src="https://media.istockphoto.com/vectors/thumbnail-image-vector-graphic-vector-id1147544807?k=20&m=1147544807&s=612x612&w=0&h=pBhz1dkwsCMq37Udtp9sfxbjaMl27JUapoyYpQm0anc=" height="64" width="64">
                                <% } %>
                            </td>
                            <td><%= product.productName %></td>
                            <td><%= product.description.substr(0, 60) %>...</td>
                            <td><%= product.category %></td>
                            <td><%= product.sku %></td>
                            <td><%= product.price %></td>
                            <td><%= product.updatedAt.toLocaleString() %></td>
                            <td><a href="/admin/edit/<%= product._id %>"><i class="bi bi-pencil-square"></i></a></td>
                            <td><a href="/admin/delete/<%= product._id %>"><i class="bi bi-trash-fill"></i></a></td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </div>
</main>

<%- include('../partials/footer') %>